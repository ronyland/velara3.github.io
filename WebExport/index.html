<!DOCTYPE html>
<html>
    <head>
      <meta charset="utf-8" />
      <title>Web Export Launcher</title>
      <style type="text/css">

      html, body {
        width:100%;
        height:100%;
        margin:0;
        padding:0;
        font-family: Georgia, Helvetica Neue, Helvetica, Verdana;
        background-color: #F6F6F6;
      }

      </style>
      <script>
        
        function onloadHandler(event = null) {
          var reg = /[?|&]l=([^&]+)/;
          var found = reg.exec(window.location.href);
          var messageSpan = document.getElementById("messageSpan");
          
          // if text parameter is found auto fill
          if (found!=null) {
            var value = deurl(found[1]);
            window.location.href = "file://" + value;
            messageSpan.textContent = "Page to redirect to: " + "file://" + value;
            //console.log(value)
          }
        }
        
        function deurl(value) {
          var time = value.charAt(0);
          var newValue = "";
          var char = "";
          var charCode = 0;
          var charCodeT = 0;

          value = decodeURIComponent(value.substr(1));

          for (var i = 0; i < value.length; i++) {
            char = value[i];
            charCode = value.charCodeAt(i);
            charCodeT = charCode - time;
            newValue += String.fromCharCode(charCodeT);
          }

          return newValue;
        }
        window.addEventListener("load", onloadHandler);
        document.addEventListener("DOMContentLoaded", onloadHandler);
        </script>
    </head>
    <body>
      <span id="messageSpan">Page content</span>
    </body>
</html>
